SQL basics: Advanced SELECT

SELECT N,
CASE 
WHEN P IS NULL THEN 'Root'
WHEN N IN (SELECT DISTINCT P FROM BST WHERE P IS NOT NULL) THEN 'Inner'
ELSE 'Leaf'
END
FROM BST
ORDER BY N;

### 1699
##### Write an SQL query to report the number of calls and the total call duration between each pair 
##### of distinct persons (person1, person2) where person1 < person2.


SELECT      CASE
            WHEN from_id > to_id THEN from_id
            ELSE to_id
            END AS person1,
            CASE
            WHEN from_id > to_id THEN to_id
            ELSE from_id
            END AS person2,
            COUNT(duration) AS call_count,
            SUM(duration) AS total_duration
FROM        Calls
GROUP BY    person1,
            person2

SELECT
    LEAST(from_id, to_id) AS person1,
    GREATEST(from_id, to_id) AS person2,
    COUNT(*) AS call_count,
    SUM(duration) AS total_duration
FROM Calls
GROUP BY person1, person2
